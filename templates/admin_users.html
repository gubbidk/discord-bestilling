{% extends "base.html" %}
{% block content %}

<h2>ğŸ‘¥ Brugere</h2>

{% if users %}
<div class="grid">
{% for uid, info in users.items() %}
    <div class="card">

        <h3>
            {{ info.name }}

            {% if info.role == "admin" %}
                <span title="Admin">ğŸ›¡ï¸</span>
            {% else %}
                <span title="Bruger">ğŸ‘¤</span>
            {% endif %}

            {% if uid in blocked %}
                <span title="Blokeret">â›” Blokeret</span>
            {% endif %}
        </h3>

        <p>
            <strong>ID:</strong> {{ uid }}<br>
            <strong>Rolle:</strong>
            {% if info.role == "admin" %}
                ğŸ›¡ï¸ Admin
            {% else %}
                ğŸ‘¤ Bruger
            {% endif %}
        </p>

        <p>
            <strong>FÃ¸rste login:</strong><br>
            {{ info.first_seen }}<br>
            <strong>Sidst set:</strong><br>
            {{ info.last_seen }}
        </p>

        <div class="actions">

            {# ğŸ”’ BLOCK / UNBLOCK #}
            {% if uid in blocked %}
                <a class="btn success" href="/admin/unblock/{{ uid }}">ğŸ”“</a>
            {% else %}
                <a class="btn danger" href="/admin/block/{{ uid }}">â›”</a>
            {% endif %}

            {# ğŸ“œ HISTORIK #}
            <a class="btn blue"
               href="/admin/user_history?uid={{ uid }}">
               ğŸ“œ Historik
            </a>

            {# ğŸ‘‘ OWNER ADMIN CONTROL #}
            {% if is_owner and uid != current_user_id %}

                {% if info.role != "admin" %}
                    <a class="btn green"
                       href="/owner/make_admin/{{ uid }}"
                       onclick="return confirm('GÃ¸r {{ info.name }} til admin?')">
                       ğŸ‘‘ GÃ¸r admin
                    </a>
                {% else %}
                    <a class="btn danger"
                       href="/owner/remove_admin/{{ uid }}"
                       onclick="return confirm('Fjern admin fra {{ info.name }}?')">
                       âŒ Fjern admin
                    </a>
                {% endif %}

            {% endif %}

        </div>
    </div>
{% endfor %}
</div>
{% else %}
<p>Ingen brugere har logget ind endnu.</p>
{% endif %}

<hr>

<div class="actions">
    <a class="btn" href="/">â¬…ï¸ Tilbage</a>
</div>

{% endblock %}
